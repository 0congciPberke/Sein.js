Sein.js致力于打造一个专业的多平台（目前已支持Web、小程序、小游戏，未来还会更多）的3D游戏开发解决方案。其特色是从引擎架构、工具链、底层建设等，均引入业界最佳实践，给出适用于Web和传统游戏从业人员的发布在多平台的通用解决方案，将原先想都不敢想的惊艳效果引入Web！  

同时我们和支付宝小程序、小游戏、Native团队等也有一致的目标，就是将Sein.js打造成为阿里小程序3D/小游戏官方解决方案！

针对这个期望，我们做出了系列的规划，这个规划的一个简洁的大图如下：  

![overview](/assets/future/0.png)

接下来让我们自底向上，勾勒出整个体系未来的规划方向

## 引擎架构

引擎的整体框架层面，Sein.js大幅借鉴了UE4的最佳实践，并融合进了一些Web游戏引擎的优雅设计（比如异常链系统），这个可以在[教程](./guide)中详细查看。对于目前的引擎版本，整体架构大部分模块基本已经稳定，但还有一些可以改进的部分在计划中。

### 资源管理层部分重构

目前资源管理层一部分落在了渲染层（主要是GlTF资源部分），这个设计是历史遗留问题，所以我们将在未来的版本解决它，使得整体资源管理策略更加可控和灵活。

### 数学层引入WASM

游戏中大量运算都是矢量运算，将这一部分迁移到WebAssembly是值得尝试的。目前Sein.js使用的是**gl-matrix**，并且开发者已经开发出了其WASM版本[gl-matrix-wasm](https://github.com/dtysky/gl-matrix-wasm)，预计不久就可以接入。

### 序列化

序列化机制，应对未来可能的需求。

## 渲染层

Sein.js采用分层架构，所以渲染层相对独立，其主要通过一个渲染系统和底层实际的渲染引擎对接。目前采用的渲染引擎是**Hilo3d**，这是一个非常优秀的基于WebGL 1.0的前向渲染引擎，目前也工作的很好。  

但Sein.js本身也是一个面向未来的引擎，所以我们做了很多规划。

### RHI(渲染引擎2.0)

随着**WebGPU**的提出，在Web端的更高级、现代的图形API也成为了必将到来的颠覆式技术，而我们必须要为此做好准备，所以我借鉴现代游戏引擎的底层设计，构想了新一代的渲染引擎架构：

![rhi](/assets/future/1.png)

这是一个通用的渲染引擎架构，同时会在顶层和Sein.js有更加紧密的关系。在我们的计划中，这个渲染层不仅仅会使用JS编写、落在浏览器上，还会利用WebAssembly以及其SystemInterface，实现真正意义上的全平台渲染。

目前已然决定计划和Hilo团队、支付宝多媒体Ant3D团队共同开发，底层会支持JS、C++、WASM等版本。

### 更多通用渲染流程

有时候我们需要不同的渲染流程来达到更加适合业务的效果，目前我们计划至少再产出一套适用于大部分适合在移动端休闲游戏场景的渲染流程，比如卡通渲染。

## 开发体系

开发体系，可以说是做游戏最重要的部分之一了。Sein.js的研发体系核心是“对接业界最佳实践，拥抱标准”。先用一张大图来看一下整体的详细开发流程：  

![development](/assets/future/2.png)

整套流程非常清晰，其对接Web开发、游戏开发标准，使用**seinjs-cli**初始化工程，**Unity**布置场景、绑定逻辑脚本、做离线烘焙等，场景序列化到**GlTF**中、并支持反序列化，在**VSCode/小程序IDE**编写代码并提供插件增强开发体验，然后可以通过引入***Inspector**组件或对应的Chrome扩展调试，最后通过**gltf-loader**或者**Paradise平台**将资源发布到包内或CDN，并将代码发布到各个容器版本最后。

目前开发体系基本都有，但还有许多地方在改进。

### CLI

CLI方面，未来还需要在现有的基础上：  

1. 加强模板功能，可以在一个地方统一管理模板，并支持第三方模板接入。
2. 加强容器功能，支持添加支持各种平台的功能，比如小程序、小游戏。

目前1还在筹备中，2已经通过CLI的重构预留了空间，等待小程序/小游戏基础能力上线后将很快实现。

### Unity Toolkit

UnityToolkit作为整个开发体系最重要的部分，目前已经支持了许许多多的Unity功能向Sein.js的接入，目前整体重写已经完成，并且支持了大量功能，将整个体系打通的更加顺滑，但我们还有更多期待：  

1. 更良好的自定义材质体验。
2. 更好的脚本接口代码自动生成。
3. 真HDR纹理的导出。
4. Morph动画、材质动画等导出。

### Webpack

Webpack作为核心开发链路的一部分，承担了相当的职能。其通过一系列Loader和Plugin支持了glTF、atlas、静态资源等等的加载，还支持压缩纹理、资源上传等等，以及多平台的适配，我们目前还有一些简化：

1. 支持微信小程序/小游戏。
2. atlas-loader支持压缩纹理功能。

### VSCode Extension

VSCode将作为主要的代码编辑器，为了对接传统游戏开发流程（场景编辑器+VS），我们选择了这条路线。目前其已然支持了**模板代码生成**能力，后续还有更多计划——打造一个集成开发环境：

1. 接入CLI的能力，将CLI的能力可视化。
2. 代码补全能力。
3. PIE集成，开一个Tab用于展示游戏画面。
4. Debugger集成。
5. Inspector集成。

### Inspector

Inspector可以展示出整个场景的系统信息，比如FPS、内存、CPU、Actor数量等，还可以展示如碰撞体、骨架等信息，以及渲染信息。  

目前我们计划提供一个可以直接引入代码的`InspectorActor`和一个基于其的Chrome扩展，方便大家调试。  

1. 系统信息的展示。分为FPS、内存、CPU、GPU占用等（若能实现）、世界关卡和渲染状态等。不需要第二部分。
2. Game信息展示。主要是Game的一些配置信息，以及配置的所有世界和关卡，以及所有的InfoActor。Actor可能需要展示一些信息（可能需要引擎内核新实现特性支持，待定）。
3. Level信息展示。这就是世界中具体的各种模型等信息的展示了，即SceneActor的展示。需要第二部分，根据当前选中的材质、模型本身等，可以进行材质信息、骨架、碰撞体等的可视化，也可以进行动画、音频的选择播放。
4. Level中的Actor筛选展示，可以通过类名、名字、正则等搜索，选中后高亮。
5. 资源系统的展示。包括有多少个加载器，有多少个资源等。
6. 事件系统，全局和挂载在每个Component下的事件。
7. 玩家系统展示。展示玩家系统当前的树状结构关系。
8. 渲染信息展示，这个可以直接引入“sepctor.js”。
9. 强扩展性，第三方自定义组件也可以接入Inspector。

目前正在和饿了么的同学一起合作开发，进展迅速。

## 生态系统

有了底层的框架和开发体系，最终还需要有生态体系，我们才能走的更远、让更多业务落地。所以我们设计了宏达的规划，致力于让更多的、不仅仅是阿里、还有全中国、世界的开发者都能使用我们的引擎，协助更多的开发者去在Web上构建虚拟世界！

下面是我们规划的生态大图：

![development](/assets/future/3.png)

### 模板

首先当然是模板了，因为Sein.js的优秀设计，其非常适合构造模板进行复用。其某种程度上依赖于**CLI**，目前而言，模板分为官方通用模板和业务模板两种，官方模板已经实现了：

1. Lite，纯渲染模板。
2. Tiny，单脚本简化框架。
3. Simple，通用框架的最简版本。

而剩下的则会很快实现：

4. Normal，Simple基础上添加Unity中的脚本绑定。
5. Online，添加为玩家系统和联机机制
6. Physic，添加物理引擎

同时业务定制模板需要依赖与平台投放，这个也在计划中。

### 容器

Sein.js目标是跨平台，所以对多容器的支持是必须的，我们和小程序/小游戏团队紧密合作，双方合作进行了适配：

1. 支付宝小程序：目前适配完成，依赖离屏Canvas上线。
2. 支付宝小游戏：目前适配完成，依赖于GUI系统上线，预计九月初。

有这方面需求的业务方可以联系过来了。

### 扩展组件/系统

同样得益于Sein.js的优秀设计，功能逻辑和业务逻辑的复用也是很简单的。比如空间音频系统，在Sein中就是作为一个第三方扩展系统引入的，其资源加载器、事件等也都是如此。

对于扩展组件和系统的规划，我们主要分为几块：

1. 基于React内核实现的、纯GL绘制的UI系统，目前开发中，很快将上线。
2. 系统增强，比如接入AR、VR能力，**AR已经在和Ant3D团队对接，预计下个月内对接完成。**
3. 特效，也就是各种材质。
4. 后处理系统。
5. 自定义渲染流程，比如卡通渲染。
6. 通用逻辑组件，比如相机控制器。
7. 玩法系统，比如建造、寻路等。
8. 基于DOM、小程序的HUD。
9. 以及更多业务形态的组件。

### 业务组件

业务组件主要是将当前线上业务的一些玩法和系统拆分出来，供大家使用。

目前惠星球业务已经是组件化开发，如果大家有这方面的需求，可以直接联系我对接。

### 业务拓展

技术最终要为业务服务，目前我们已经有一些线上业务在很好得运作，详见[产品](./future)，并且基于这些业务的经验，我们会做得更多更好，目前来讲，我们主要的发力点是：  

1. 商家业务。商家方向有很大的3D方向的潜力，不限于物料展示、新型交互等，我们和商家团队合作紧密，在持续进行。
2. 营销业务。主要以惠星球为平台的营销业务，达成一个良好的业务生态，这部分已经在运作。
3. 个创业务。主要以蚂蚁庄园为平台，我们已经在开发新的3D项目，励志让整个支付宝的3D上限提高。
4. 公益业务。主要以蚂蚁森林为载体。
5. 品牌输出。主要是我们的一个内部大型企划，正在稳步进行。

当然实际的场景远不止这么些，这一部分是Sein全部成员一起持续努力的方向，我们会不断探索新场景。

### 资源市场

资源方面主要依赖于支付宝的春茧平台。但由于目前我们自产资源不会很多，所以Sein.js工作体系的好处就出来了——只要可以导入Unity的模型，我们理论上都可以用。

所以我们可以直接使用Unity资源商店、Sketchfab等商店的各种模型资源。  

### 对外

最后就是对外输出了，我们做了许多规划，想把整个引擎的能力推出去：

1. 做游戏不仅仅是开发者自己的事，也是业务和设计同学的事，所以我们需要内部分享，拉大家一起展示案例、脑暴。
2. 对于开发者，我们准备开课，教大家怎么使用引擎开发一个游戏。
3. 同时有时间我们也会发文章，讲述引擎内部实现的一些细节，让大家更了解引擎。
4. 后续我们可以举办内部的Gamejam，也可以参加外部的Gamejam进行推广。

### 开源

本引擎和整套开发体系预计年底前完全开源，造福社会。
